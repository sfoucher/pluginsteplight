Article

Comparison of Three Algorithms to Estimate Tree
Stem Diameter from Terrestrial Laser Scanner Data
Joris Ravaglia 1, *,‚Ä† , Richard A. Fournier 2 , Alexandra Bac 1 , C√©dric V√©ga 3 , Jean-Fran√ßois C√¥t√© 4 ,
Alexandre Piboule 5 and Ulysse R√©millard 2
1
2
3
4
5

*
‚Ä†

G-Mod, Laboratoire d‚ÄôInformatique et des Syst√®mes UMR CNRS 7020, Aix-Marseille Universit√©,
13288 Marseille CEDEX 09, France
Department of Applied Geomatics, Centre d‚ÄôApplications et de Recherches en T√©l√©d√©tection,
Universit√© de Sherbrooke, Sherbrooke, QC J1K 2R1, Canada
Institut National de l‚Äôinformation G√©ographique et Foresti√®re, Laboratoire d‚ÄôInventaire Forestier,
54000 Nancy, France
Canadian Wood Fibre Centre, Canadian Forest Service, Natural Resources Canada,
Qu√©bec, QC G1V 4C7, Canada
P√¥le Recherche D√©veloppement Innovation, Office National des For√™ts, 54500 Villiers-l√®s-Nancy, France
Correspondence: joris.ravaglia@univ-amu.fr
Current address: LIS UMR CNRS 7020, Aix Marseille Universit√©, Campus de Luminy‚Äî163 Avenue de
Luminy, Case 901, BP 5, 13288 Marseille CEDEX 9, France.

Received: 1 April 2019; Accepted: 15 July 2019; Published: 18 July 2019




Abstract: Terrestrial laser scanners provide accurate and detailed point clouds of forest plots, which can
be used as an alternative to destructive measurements during forest inventories. Various specialized
algorithms have been developed to provide automatic and objective estimates of forest attributes from
point clouds. The STEP (Snakes for Tuboid Extraction from Point cloud) algorithm was developed
to estimate both stem diameter at breast height and stem diameters along the bole length. Here,
we evaluate the accuracy of this algorithm and compare its performance with two other state-of-the-art
algorithms that were designed for the same purpose (i.e., the CompuTree and SimpleTree algorithms).
We tested each algorithm against point clouds that incorporated various degrees of noise and occlusion.
We applied these algorithms to three contrasting test sites: (1) simulated scenes of coniferous stands in
Newfoundland (Canada), (2) test sites of deciduous stands in Phalsbourg (France), and (3) coniferous
plantations in Quebec, Canada. In most cases, the STEP algorithm predicted diameter at breast height
with higher R2 and lower RMSE than the other two algorithms. The STEP algorithm also achieved
greater accuracy when estimating stem diameter in occluded and noisy point clouds, with mean errors
in the range of 1.1 cm to 2.28 cm. The CompuTree and SimpleTree algorithms respectively produced
errors in the range of 2.62 cm to 6.1 cm and 1.03 cm to 3.34 cm, respectively. Unlike CompuTree or
SimpleTree, the STEP algorithm was not able to estimate trunk diameter in the uppermost portions of
the trees. Our results show that the STEP algorithm is more adapted to extract DBH and stem diameter
automatically from occluded and noisy point clouds. Our study also highlights that SimpleTree and
CompuTree require data filtering and results corrections. Conversely, none of these procedures were
applied for the implementation of the STEP algorithm.
Keywords: forest inventory; stem diameter; diameter at breast height (DBH); terrestrial laser scanner;
STEP algorithm; CompuTree; SimpleTree; LiDAR

1. Introduction
Long-term preservation of forest resources can only be achieved through accurate forest monitoring
and reliable forest inventories, which are accomplished using precise measuring methods. The precise
Forests 2019, 10, 599; doi:10.3390/f10070599

www.mdpi.com/journal/forests

Forests 2019, 10, 599

2 of 19

measurement of key forest attributes contributes to our understanding of complex ecological processes.
Among these attributes, diameter at breast height (DBH, diameter of the trunk at 1.30 m above
the ground-surface) and stem diameter as a function of height are of particular importance for
forest inventories.
DBH measurement has become an essential part of a forester‚Äôs practice and is now a reference
variable for the development of allometric models. These models tie DBH to many useful structural
variables, especially tree height [1], merchantable or total wood volume [2], biomass [3], and total
leaf area [4]. During traditional forest inventories, operators measure DBH using calipers or diameter
tapes. However, the operator‚Äôs visual estimates of the measurement leads to potential errors [5‚Äì7].
For example, with calipers, a deviation angle of 2.5 degrees may produce an estimated error of 2 cm on
large trees [6].
Diameter values along the stem, or stem profile, are crucial to enhance wood volume equations
and to estimate the useful portion of the stem for wood supply. For most of the stem length, its diameter
is more difficult to measure in situ than DBH: logistical issues preclude non-destructive measures.
For instance, measuring a standing tree requires that a field operator climb the trunk, limiting the
height to which stem diameter measurements can be taken. Consequently, stem diameter cannot be
consistently measured as a function of height during forest inventory campaigns with non-destructive
methods. Different solutions may be considered for acquiring stem diameter: it can be either measured
manually through a destructive protocol or estimated with the help of precise scanning technologies.
Stem profile is measured with destructive protocols that involve felling the trees of interest and
cutting the logs into shorter segments. Log circumference can then be measured to obtain a set of
diameters along the stem. In the past, field campaigns have been specifically designed to include tree
cutting to measure tree stems [8]. However, felling trees is neither an acceptable nor a sustainable
practice for most forest inventory plots. Destructive sampling can only be considered for specific
purposes: it is incompatible with permanent plot monitoring because of ecological and logistical issues.
Consequently, destructive measurements are not a practical solution for regular forestry inventory
plots. An efficient solution remains to be developed, without requiring destructive sampling.
Laser scanning technologies become an essential non-destructive solution to monitoring forest
environments [9]. LiDAR (Light Detection and Ranging) instruments provide 3D point clouds of their
surroundings, containing several tens of millions of points. Two major types of LiDAR instruments
have been used to monitor forest environments [10]: airborne laser scanners (ALS) and terrestrial
laser scanners (TLS). An ALS is mounted on an aircraft flying over the study area. While it is possible
to derive some structural attributes from ALS data, algorithms are mainly designed for stand-level
measurements (e.g., aboveground biomass [11]) and for tree attributes that are readily available from
above the trees (e.g., tree height [12]; crown area [13]; gaps between crowns [14]). Tree stems are poorly
probed with ALS systems because of signal occlusion by the upper canopy. In addition, the ALS point
cloud is generally not dense enough to accurately estimate the stem diameter. In contrast, TLS are
located on the ground. They emit laser beams in a spherical pattern and convert signal returns into
high-density point clouds. TLS can capture stem shape accurately from the lower part of the tree to the
top. Yet, TLS data are limited not only by signal occlusion, but also by noise (signal returns not related
to a scene object) and non-homogeneous sampling densities. Therefore, there is a need for specialized
point-cloud processing algorithms to estimate tree attributes from TLS point clouds [15].
Estimating tree attributes via specialized algorithms offers several advantages: they do not
require destructive sampling, and allow to estimate several tree attributes that could not be otherwise
measured in the field, such as crown shape and competition [16,17], plant area index [18‚Äì20], tree
architecture [21,22], and wood fibre attributes [23]. TLS data processing algorithms have thus received
much attention in the past few years. Several algorithms have been developed to estimate the structural
attributes of trees from TLS point clouds (a review is presented in [15]). In particular, algorithms
were proposed for estimating DBH and stem profile. Most of these algorithms assume that a stem

Forests 2019, 10, 599

3 of 19

cross-section is circular in shape. Thus, they aim to reconstruct stems as a series of circles, or as portions
of elliptical surfaces (namely, cylinders and cones).
Circle fitting has successfully retrieved DBH and stem profile from point clouds. These approaches
use clustering methods to select appropriate points within layers and apply either least-squares circle
fitting [24‚Äì30], a RANSAC algorithm [31], or other methods to retrieve the stem‚Äôs centre position
and radius [32]. More general ellipse fitting has been tested [33‚Äì36], but it tends to be sensitive and
unstable [37]. Previous studies show radius estimation errors can range from 1 cm to 3 cm [38‚Äì40].
However, algorithms provide erroneous models when the point cloud is affected by occlusion and noise.
Cylinders have also been used to tackle the issue of circle orientation and the choice of
appropriate layers [41‚Äì43]. Algorithms have been implemented, such as iterative least-squares
cylinder fitting [44] and robust variants using normal information [45,46], or MSAC (M-estimator
SAmple and Consensus) [47]. Despite the accuracy of the results, cylinder-based methods are limited
by the same factors as circle-based methods.
Tree stem reconstruction as a series of cones was introduced to estimate local tapering of the
trunk [48,49], with no major improvement regarding the method‚Äôs robustness. Other approaches either
retrieve a more precise perimeter estimate through b-spline fitting [44], or estimate tree volume by
using polygons [50]. These methods result in precise measurements, but require that all of the stems
be probed. Therefore, they cannot be applied to single scan data or occluded point clouds.
Another approach to estimating DBH from TLS data identifies circles along the stems using the
Hough transform (HT) [38]. As a powerful pattern recognition tool, HT exhibits robustness to both
occlusion and noise. It has been successfully used as a prelocalization tool or applied in combination
with classical circle fitting [29‚Äì31,51,52]. Many solutions for estimating diameter along the stem have
been proposed, but occlusion and noise affect most of the algorithms. Consequently, robust methods
are still in demand [53].
In an attempt to overcome the limitations of TLS, we developed a new algorithm that is based upon
a HT variant called STEP (Snake for Tuboid Extraction from Point cloud) [54]. The STEP algorithm was
designed to estimate stem profile in natural forest environments. However, it has not been thoroughly
tested on point clouds that have been collected by TLS in forest stands. Stem profile can also be
estimated with algorithms that are designed to simulate tree architecture [21,22,55], or with quantitative
structural models (QSM) [40,56‚Äì58]. These QSM, including SimpleTree software [59], use cylinders to
provide a complete description of a tree, including its architecture, stem and branch diameters, and
total volume. Yet, their accuracy depends upon the quality of the input point cloud.
There is a need (1) to benchmark these methods to understand their respective advantages and
(2) to evaluate their accuracy in various natural forest environments. This study aims to evaluate the
STEP algorithm on a diversified set of TLS acquisitions in natural forest environments. As a second goal,
we also compared the performance of the STEP algorithm with that of other algorithms. Consequently,
our main objective was to assess the accuracy of the STEP algorithm when applied to a range of
TLS acquisition protocols for stem profile estimation. This goal was reached through two specific
objectives. First, we selected contrasting test sites representing natural forest environments; each site
was related to a reliable set of reference stem diameter measurements. This allowed us to compare the
estimated values with well-documented measurements that were used as reference values. Second, we
selected three stem profile estimation algorithms representing distinct strategies. We compared the
reference measurements with the estimation results of (1) the STEP algorithm [54], (2) the advanced
cylinder-fitting algorithm that was available in the CompuTree software platform [24], and (3) the
SimpleTree QSM algorithm [59].
These three algorithms were all implemented as plug-ins within the CompuTree software platform.
The goal of this platform is to regroup TLS point cloud processing algorithms for forest scene analyses.
It provides a full development environment based on powerful C++ libraries, and eases the implementation
of various methods as plug-ins for comparative and exchange purposes. Benchmarking should provide
insights into each of the three algorithms that were selected for the estimation of stem profile.

Forests 2019, 10, 599

4 of 19

2. Benchmarked Algorithms for Stem Diameter Estimations
2.1. STEP Algorithm
The STEP algorithm was first introduced by Ravaglia et al. [54]. It reconstructs tuboids that are
defined as a series of circles with continuous locations, radii and orientations. The STEP algorithm
was designed to optimize stem diameter estimation by a two-stage process, while considering the
limitations of TLS data (signal occlusion, noise and uneven sampling). The first stage of the algorithm
is an efficient variant of HT that has been adapted to circles. This computation is based upon normal
directions and produces a discrete 4D space in which each element represents an occurrence of a circle.
A score is assigned to each element, corresponding to the number of points that are located on the
corresponding circle. The score of each circle hence reflects the level of confidence of being an accurate
model of the data. In the second stage of STEP, growing active contours are used to extract a series of
circles with a high score, which correspond to tree stems.
A major limitation of applying classical HT to point clouds is its complexity, which leads to
computationally expensive methods. However, HT is robust to occlusion and noise. We introduced
normal vectors in a variant of HT in order to reduce its complexity, while benefiting from its advantages.
We used an efficient ray tracing algorithm to compute the 4D discrete accumulator space (three
dimensions for the circle‚Äôs centre and one dimension for its radius) in linear time [60]. For the first
stage of the calculation, each cell of this space corresponds to a 3D circle and is associated with a score
reflecting the reliability of the circle.
As a series of contiguous 3D circles, tuboids are represented by continuous curves in the
accumulator space. Hence, the second stage of the procedure aims at extracting curves passing through
the elements that have a high score. We tackled this issue with growing active contours [61]: we grew
a curve in the accumulator space until a growth-stopping criterion (based upon principal component
analysis) was reached. This curve was then considered an active contour. Active contours are curves
that minimize an energy, including constraints regarding the shape and location of the curve. In our
application, we used the energy E g to ensure the geometric accuracy of the active contour c(u) and to
force it to pass through high score elements in the accumulator space:
Z
Eg =

[Ei (c(u)) + Ed (c(u))kc0(u)k]du

(1)

where Ei (c(u)) = Œ±kc0(u)k2 + Œ≤kc0(u)k2 is an internal energy term constraining the elasticity and
smoothness of the curve, and Ed (c(u))kc0(u)k is used to compute the linear integral of a data energy
term constraining the curve to pass through the elements with a high score:
Ed (c(u)) = a

Hm ‚àí H (u)
hm ‚àí H ( u )
+ (1 ‚àí a)
HM ‚àí Hm
hM ‚àí hm

(2)

where a ‚àà [0, 1] is a balancing term, Hm and HM are respectively the minimum and maximum scores
of the accumulator space, and hm and hM are respectively the local minimum and maximum of the
accumulator space around c(u). Further details on curve initialization and the optimization procedure
that is used to reach the minimum energy are given in [54].
The results of the STEP algorithm depend upon the quality of the normal vector estimates, which
remains a challenging task [62]. The main limitations of the STEP algorithm are either the main
memory it requires, or its computational time that is due to the use of sparse matrices, depending upon
the implementation.
2.2. Cylinder Fitting Algorithm
The Office National des For√™ts (ONF, French forest office) introduced the CompuTree
software platform which includes a stem diameter estimation algorithm based upon the work

Forests 2019, 10, 599

5 of 19

of Ohtmani et al. [24]. It will be referred to as the CompuTree cylinder fitting algorithm (or CCF
algorithm) from this point onward. The CCF algorithm was selected because it represents the family of
algorithms that use cylinder- or cone-fitting to estimate stem diameter (e.g., [15,48,63]).
The CCF algorithm starts by removing the branches of the trees from the original point cloud
with a convolution filter. The algorithm then divides the point cloud into horizontal layers of a fixed
thickness. A Euclidean clustering procedure segments each stem individually in these horizontal layers.
A cylinder is then fitted to the segments using least-squares optimization. More details regarding this
stem diameter estimation process and its evolution of the CCF algorithm since it was first presented
can be found on the Computree platform website [64].
The CCF algorithm was designed to require little computational time when applied to a forest
plot, while being able to provide accurate estimates of tree location, DBH and stem diameter. It has
already demonstrated its efficiency with high stem detection rates [24]. Even though its parameters are
intuitive, the CCF algorithm must be parameterized for the point cloud specifications and forest stand
characteristics. These parameters include different thresholds that are applicable to 3D convolution
filters, Euclidean clustering, and least-squares fitting. Even though the CCF algorithm presently cannot
detect horizontal branches, it is adapted to be used with TLS point clouds to estimate DBH and stem
diameter in forest inventory applications.
2.3. SimpleTree
We selected SimpleTree, which is a QSM algorithm that was developed by Hackenberg et al. [59],
as a third algorithm for our comparative study, since it is considered state-of-the-art. We used a version
available as a plug-in from the CompuTree platform. A summary of the SimpleTree method follows.
The SimpleTree algorithm provides a tree model (including branches) that is formed by
interconnected cylinders that have been generated from circle fittings. It starts modelling the tree from
an estimated circle C0 at the base of the stem. The centre of C0 is used to position a cutting sphere S0
with a radius greater than that of C0 . The intersection between S0 and the input point cloud represents
a cross-section of the stem. A circle C1 is then fitted to the cross-section points and a new sphere S1
is generated at the centre of C1 . The stem is iteratively reconstructed by moving the cutting spheres
Si along the fitted circles Ci . When a cutting sphere intersects several cross-sections, a new branch
is detected and reconstructed with the same procedure. The results of the SimpleTree algorithm are
available as hierarchical series of cylinders that are derived from the fitted circles Ci .
The SimpleTree sphere following method runs iteratively until it retrieves the entire tree structure,
including the branch diameters and order. It has been enhanced with automatic parameterization,
optimization and forestry knowledge, including allometry. However, it requires that the tree be
isolated in a single point cloud. We use SimpleTree in the present benchmark to better understand its
advantages and limitations over a wide range of natural forest stand acquisitions.
3. Materials and Methods
3.1. Test Sites and Data Sets
Only a few forest sites matched our field requirements for this benchmarking (i.e., natural
environments, with associated reference diameter measurements). We selected three test sites with
different, yet accurate, reference measurements to evaluate the selected algorithms. These sites provide
diverse structural configurations and different data quality levels. They offer a variety of locations,
forest environments, species, data sources, and acquisition protocols.
The three algorithms (STEP, CCF algorithm and SimpleTree) were applied at a tree-level to
81 isolated trees: 24 were from a simulated dataset replicating forest plots in the Province of
Newfoundland and Labrador (Canada), 40 were from the Phalsbourg dataset that was collected in the
Grand Est region (France), and 17 were from the Bas Saint-Laurent dataset that was collected in the
Province of Qu√©bec (Canada). The three test sites provided appropriate reference measurements to

Forests 2019, 10, 599
Forests 2019, 10, 599

6 of 19
6 of 19

provided
with
leaf-on
scans
and various
degrees
of occlusion
and noise.
Table 1
evaluate various
the threelimitations
algorithms
with
a large
number
of trees in
simulated
and natural
environments.
presents
a summary
of the trees
that
were selected
frommultiple
each dataset
forThese
evaluation
along
the
They included
both coniferous
and
deciduous
trees, and
species.
datasets
also with
provided
corresponding
scanning
protocol.
various limitations with leaf-on scans and various degrees of occlusion and noise. Table 1 presents a
summary of the trees that were selected from each dataset for evaluation along with the corresponding
Table
1. Overview of the data set characteristics and scanning protocol for the three test sites.
scanning
protocol.
Study Site

Newfoundland

Phalsbourg
Bas Saint-Laurent
Mixed
Coniferous
Stand type
Coniferous
Study Site
Newfoundland
Phalsbourg
Bas Saint-Laurent
(mainly
deciduous)
Black Spruce
Common
Mixedbeech
Coniferous
Stand
type
Coniferous
Tree
species
White
spruce
(mainly
deciduous)
Balsam Fir
Hornbeam
Black Spruce
Common beech
White 17
spruce
species trees
NumberTree
of selected
24 Fir
40
Balsam
Hornbeam
Number
of selected
Minimum
DBHtrees
5.4324cm
1040cm
917cm
Minimum
DBH
5.43
cm
10
cm
9
Maximum DBH
19.88 cm
70 cm
40cmcm
Maximum DBH
19.88 cm
70 cm
40 cm
¬©
Faro
Focus3D3D
A120
TLS
Simulated
(PBRT)
Faro
Focus3D3D
¬©
¬© ¬©
TLSscanner
scanner
Simulated (PBRT)
Faro Focus
Faro Focus
A120
‚ó¶
Scanner
angular resolution
resolution
0.036‚ó¶
0.036‚ó¶
0.018
Scanner
angular
0.036¬∞
0.036¬∞
0.018¬∞
Table 1. Overview of the data set characteristics and scanning protocol for the three test sites.

Number of scans per plot

5

Number of scans per plot

4

5

4

4

4

3.1.1. Newfoundland Dataset
3.1.1. Newfoundland Dataset
The first dataset is a collection of three simulated forest plots. Each virtual plot was populated
The first dataset is a collection of three simulated forest plots. Each virtual plot was populated
with tree models that were obtained from the architectural model L-Architect [22,55]. The model
with tree models that were obtained from the architectural model L-Architect [22,55]. The model
positions each simulated tree according to a tree map location. L-Architect provided the optimal
positions each simulated tree according to a tree map location. L-Architect provided the optimal
representation of plots for forests in insular Newfoundland (Canada) that are dominated by balsam fir
representation of plots for forests in insular Newfoundland (Canada) that are dominated by balsam
(Abies balsamea (L.) Mill.) and black spruce (Picea mariana (Mill.) BSP). Three virtual forest plots with
fir (Abies balsamea2 (L.) Mill.) and black spruce (Picea mariana (Mill.) BSP). Three virtual forest plots
an area of 900 m (square plots with 30 m edges) were generated and contained 30, 71 and 92 trees,
with an area of 900 m2 (square plots with 30 m edges) were generated and contained 30, 71 and 92
respectively. In all three plots, we applied random tree selection stratified by 10 cm tree diameter
trees, respectively. In all three plots, we applied random tree selection stratified by 10 cm tree
classes. We selected 24 virtual trees with DBH values ranging from 10.86 cm to 39.76 cm.
diameter classes. We selected 24 virtual trees with DBH values ranging from 10.86 cm to 39.76 cm.
TLS acquisitions of these virtual forest plots were simulated using a physically based ray tracing
TLS acquisitions of these virtual forest plots were simulated using a physically based ray tracing
tool with the following scan settings [65]: (1) all scans used an angular resolution of 0.036‚ó¶ for rays
tool with the following scan settings [65]: (1) all scans used an angular resolution of 0.036¬∞ for rays
that were emitted throughout the full field-of-view of the instrument, (2) rays were simulated with no
that were emitted throughout the full field-of-view of the instrument, (2) rays were simulated with
divergence, and (3) five scans were co-registered as a quincunx: one scan was taken in the centre of
no divergence, and (3) five scans were co-registered as a quincunx: one scan was taken in the centre
the plot, and four were taken at each extremity of the plot (north, south, east, west). The soil was not
of the plot, and four were taken at each extremity of the plot (north, south, east, west). The soil was
modelled by L-Architect. The ray tracing simulations resulted in noiseless point clouds. The trees
not modelled by L-Architect. The ray tracing simulations resulted in noiseless point clouds. The trees
that were included in the virtual plots had a large number of branches. This generated numerous
that were included in the virtual plots had a large number of branches. This generated numerous
occlusions of varying importance along the tree stems (Figure 1). These simulated plots were designed
occlusions of varying importance along the tree stems (Figure 1). These simulated plots were
to evaluate the effects of occlusion and non-homogeneous density since the point clouds were noiseless
designed to evaluate the effects of occlusion and non-homogeneous density since the point clouds
and the stems were perfectly cylindrical. The trees were later isolated in the resulting point clouds to
were noiseless and the stems were perfectly cylindrical. The trees were later isolated in the resulting
apply the stem diameter estimation algorithms at the tree level.
point clouds to apply the stem diameter estimation algorithms at the tree level.

(a)

(b)

(c)

(d)

Figure
Figure1.1.Examples
Examplesofofsimulated
simulatedpoint
pointclouds
cloudsfrom
fromthe
theNewfoundland
Newfoundlanddata
dataset.
set.Even
Eventhough
thoughthe
thepoint
point
clouds
were
noise-free,
they
suffered
from
branch
occlusion.
(a)
Isolated
tree;
(b)
Close-up
clouds were noise-free, they suffered from branch occlusion. (a) Isolated tree; (b) Close-upview
viewofof
branches;
branches;(c)
(c)Isolated
Isolatedtree;
tree;(d)
(d)Close-up
Close-upview
viewof
ofbranches.
branches.

Forests 2019, 10, 599

7 of 19

Forests 2019, 10, 599

7 of 19

Simulated TLS acquisitions of the virtual forest plots are approximations of real scans. However,
Simulated TLS acquisitions of the virtual forest plots are approximations of real scans. However,
the L-Architect model provided exact reference values for stem diameter: starting from the tree base,
the L-Architect model provided exact reference values for stem diameter: starting from the tree base,
the model specified the stem diameter at every 10 cm increment.
the model specified the stem diameter at every 10 cm increment.
3.1.2. Phalsbourg Data Set
3.1.2. Phalsbourg Data Set
The second dataset contains several TLS point clouds that were acquired in natural forest
The
secondItdataset
containsduring
severala TLS
clouds
that were
in natural
environments.
was collected
fieldpoint
inventory
campaign
in acquired
2013 by the
researchforest
and
environments.
It
was
collected
during
a
field
inventory
campaign
in
2013
by
the
research
and
development department of the ONF. The study area was located near the city of Phalsbourg,
in
development
department
of
the
ONF.
The
study
area
was
located
near
the
city
of
Phalsbourg,
in
northeastern France. The selected permanent forest plots (circular plots with a 15 m radius) included
northeastern
France.allThe
selected
permanent
forest
(circular
withwith
a 15 ampredominance
radius) included
12 different stands,
of which
were
dominated
by plots
deciduous
treeplots
species,
(in
12
different
stands,
all
of
which
were
dominated
by
deciduous
tree
species,
with
a
predominance
(in
decreasing order) of common beech (Fagus sylvatica L.) and hornbeam (Carpinus betulus L.), Norway
decreasing
order)
of common
sylvatica
L.) and
betulus
L.),The
Norway
spruce (Picea
abies (L.)
H. Karst),beech
Scots(Fagus
pine (Pinus
sylvestris
L.),hornbeam
and silver(Carpinus
fir (Abies alba
Mill.).
plots
spruce
(Picea
abies
(L.)
H.
Karst),
Scots
pine
(Pinus
sylvestris
L.),
and
silver
fir
(Abies
alba
Mill.).
were scanned during leaf-on season and the DBH of the inventoried trees ranged from 10 cm to 70The
cm.
plots
were scanned
leaf-onwe
season
and40
the
the inventoried
trees ranged
from
10 cm by
to
To evaluate
the threeduring
algorithms,
selected
ofDBH
theseoftrees
by using stratified
random
selection
70
cm.DBH
To evaluate
the
three 2).
algorithms, we selected 40 of these trees by using stratified random
10 cm
class bins
(Figure
selection by 10 cm DBH class bins (Figure 2).

(a)

(b)

(c)

(d)

Figure
of the
the Phalsbourg
Phalsbourg test
test sites.
sites. The
Figure 2.
2. Examples
Examples of
of point
point clouds
clouds acquired
acquired at
at one
one of
The point
point clouds
clouds
exhibit
large
occluded
areas
on
the
stem.
(a)
Isolated
tree;
(b)
Close-up
view
of
branches;
exhibit large occluded areas on the stem. (a) Isolated tree; (b) Close-up view of branches; (c)
(c) Isolated
Isolated
tree;
tree; (d)
(d) Close-up
Close-up view
view of
of branches.
branches.
¬© scanner
‚ó¶ . EachEach
¬© scanner
Plots were
were scanned
scannedwith
witha aFaro
Faro
Focus
with
angular
resolution
of 0.036¬∞.
Focus
3D3D
with
an an
angular
resolution
of 0.036
plot
plot
was scanned
a central
position
threelocations,
other locations,
an equilateral
was scanned
from from
a central
position
as wellasaswell
threeasother
formingforming
an equilateral
triangle
triangle
7.5 from
m away
plot‚Äôs
centre.
The scan
settings
induced a non-homogeneous
sampling
7.5 m away
the from
plot‚Äôsthe
centre.
The
scan settings
induced
a non-homogeneous
sampling density,
and
density,
and of
thefoliage
presence
of foliage
during theresulted
acquisitions
resultedoccluded
in numerous
The
the presence
during
the acquisitions
in numerous
areas.occluded
The scansareas.
included
scans
noise,
which
was in
mostly
located
in of
thethe
upper
the trees.
This dataset
allowed
noise, included
which was
mostly
located
the upper
part
trees.part
Thisofdataset
allowed
us to assess
the
us
to assess
the effects
occlusion,
noiseon
and
density of
onthe
thealgorithms.
performance
the algorithms.
effects
of occlusion,
noiseofand
point density
thepoint
performance
The of
selected
trees were
The
selected
trees werepoint
isolated
into
point clouds
by using
a cylindrical
extraction
isolated
into individual
clouds
by individual
using a cylindrical
extraction
of points
around their
centre. of
points
around
their
centre.
During
the
field
campaign, inventoried trees were cut down at breast height. Stems were then
the field
campaign,
inventoried
wereatcut
breast
Stems were
then
felledDuring
and further
cut into
2 m-long
logs. The trees
diameter
thedown
end ofateach
log height.
was measured
manually
felled
cut(measurements
into 2 m-long logs.
Theatdiameter
at the end
of each
log1.30
wasm
measured
manually
twice and
withfurther
a caliper
taken
right angles).
Starting
from
above the
ground
twice
with
a caliper
(measurements
taken at right
angles).
Startingfrom
frombreast
1.30 m
above
theserved
ground
surface,
manual
measurements
were available
at each
2 m increment
height
and
as
surface,
measurements
were
available
at each
2 m increment
from
breast height
and served
referencemanual
values for
stem diameter.
With
such data,
the results
of the three
algorithms
on natural
forest
as
reference
for stem
diameter. field
Withmeasurements.
such data, the results of the three algorithms on natural
sites
could bevalues
compared
to traditional
forest sites could be compared to traditional field measurements.
3.1.3. Bas Saint-Laurent Dataset

3.1.3.The
Bas Saint-Laurent
third dataset Dataset
groups several TLS point clouds that were acquired in a tree plantation.
A research
team
from
the
Universit√©
Qu√©bec
Rimouski
a field campaign
in the nature
The third dataset groups
severaldu
TLS
point √†clouds
that had
wereled
acquired
in a tree plantation.
A
reserve ofteam
Matane
during du
the Qu√©bec
autumn √†ofRimouski
2014. Thehad
plantation
of white
sprucein(Picea
glauca
research
from(Qu√©bec)
the Universit√©
led a field
campaign
the nature
(Moench)
is located
in during
the balsam
fir-yellow
domain
[66]. spruce
A 60 m(Picea
√ó 15 m
plot
reserve
of Voss)
Matane
(Qu√©bec)
the autumn
of birch
2014. bioclimatic
The plantation
of white
glauca
was established
in located
the plantation
and divided
into four
m √ó 15 m domain
subplots.[66].
TheAresulting
subplots
(Moench)
Voss) is
in the balsam
fir-yellow
birch15
bioclimatic
60 m √ó 15
m plot
included
trees with
DBHs
rangingand
from
9 cm tointo
40 cm.
with stratified
random subplots
selection
was
established
in the
plantation
divided
fourWe
15 proceeded
m √ó 15 m subplots.
The resulting
included trees with DBHs ranging from 9 cm to 40 cm. We proceeded with stratified random selection

Forests 2019, 10, 599
Forests 2019, 10, 599

8 of 19
8 of 19

Forests
10, 599
with2019,
10 cm
DBH

8 of 19
class bins. We selected 17 trees with a DBH ranging from 9 cm to 37 cm for
the
evaluation
of
the
three
stem
diameter
estimation
algorithms
(Figure
3).
with 10 cm DBH class bins. We selected 17 trees with a DBH ranging from 9 cm to 37 cm for the
with 10 cm DBH class bins. We selected 17 trees with a DBH ranging from 9 cm to 37 cm for the
evaluation of the three stem diameter estimation algorithms (Figure 3).
evaluation of the three stem diameter estimation algorithms (Figure 3).

(a)

(b)

(c)

(d)

Figure 3. Examples
of point clouds
LiDAR at the
(a)
(b) acquired with a terrestrial
(c)
(d) Bas Saint-Laurent test
sites, mainly composed of white spruce. The point clouds exhibit significant occluded areas and noise
Figure
of
clouds
acquiredview
withaof
aterrestrial
terrestrial
LiDAR
Bas
Saint-Laurent
test
Figure
3.Examples
Examples
ofpoint
point
clouds
acquired
with
at at
thethe
Bas
Saint-Laurent
sites,
on the3.stem.
(a) Isolated
tree;
(b) Close-up
branches;LiDAR
(c) Isolated
tree;
(d)
Close-uptest
view
of
sites,
mainly
composed
of
white
spruce.
The
point
clouds
exhibit
significant
occluded
areas
and
noise
mainly
composed of white spruce. The point clouds exhibit significant occluded areas and noise on the
branches.
onstem.
the stem.
(a) Isolated
tree;
(b) Close-up
of branches;
(c) Isolated
(d) Close-up
view of
(a) Isolated
tree; (b)
Close-up
view ofview
branches;
(c) Isolated
tree; (d)tree;
Close-up
view of branches.
branches.
The plot was scanned using a Faro Focus 3D A120¬© scanner with an angular resolution of 0.018¬∞.

The plot
was four
scanned
using
Faro Focus
scanner
with
an angular
resolution
0.018‚ó¶ .
For each
subplot,
scans
werea acquired
at 3D
theA120¬©
plot borders
(7.5
m away
from the
subplotofcentre),
For
eachplot
four
scans
were
acquired
at
plot
borders
(7.5
manaway
from
the subplot
centre),
The
wasof
scanned
using
a Faro
3Dthe
A120¬©
scanner
with
angular
resolution
of 0.018¬∞.
yielding
asubplot,
total
13 scans
(Figure
4). Focus
The resulting
point
clouds
included
abundant
occlusions
and
yielding
a
total
of
13
scans
(Figure
4).
The
resulting
point
clouds
included
abundant
occlusions
and
For
each
subplot,
fourvegetation
were
acquiredand
at the
plot borders
(7.5 m away
from
subplot the
centre),
noise
due
to dense
(branches
needles).
This dataset
allowed
us the
to validate
three
noise
due
toindense
vegetation
(branches
needles).
This
dataset
allowed
us
validate
the noisy
three
yielding
a total
of 13coniferous
scans (Figure
4). The and
resulting
point
clouds
included
abundant
occlusions
and
algorithms
real
plantation
sites
and to
analyze
their
resilience
to to
occluded
and
algorithms
in
real
coniferous
plantation
sites
and
to
analyze
their
resilience
to
occluded
and
noisy
point
noise
due
to
dense
vegetation
(branches
and
needles).
This
dataset
allowed
us
to
validate
the
three
point cloud data. The selected trees were manually isolated into separate point clouds for further
cloud
data.inThe
treesplantation
were manually
into separate
clouds
furtherand
processing.
algorithms
realselected
coniferous
sites isolated
and to analyze
their point
resilience
to for
occluded
noisy
processing.
point cloud data. The selected trees were manually isolated into separate point clouds for further
processing.

Figure 4.
4. Scanning
acquisition at
the Bas
Bas Saint-Laurent
Saint-Laurent test
test
Figure
Scanning set-up
set-up adopted
adopted for
for the
the terrestrial
terrestrial LiDAR
LiDAR acquisition
at the
site. Each of the four sub-plots (black) were scanned from four different
different positions
positions (red).
(red).
Figure 4. Scanning set-up adopted for the terrestrial LiDAR acquisition at the Bas Saint-Laurent test
site.
Each ofmeasurements
the four sub-plots
(black)
scanned
four
different positions
(red).
Manual
were
notwere
included
in
the
protocol.
The reference stem
included
infrom
the measurement
measurement
protocol.

¬© scanner
diameters were obtained from
scanner is an accurate log
from the
the True-Shape
True-Shape¬©¬© scanner.
scanner. The True-Shape
True-Shape¬©
Manual
measurements
wereproducts
not included
in the
measurement
The reference
stemby
scanning
unit
usedby
bythe
theforest
forest
products
industry.
scans
stems
a very
high-density
sampling
unit
used
industry.
It Itscans
stems
at at
a protocol.
very
high-density
sampling
¬© scanner. The True-Shape¬© scanner is an accurate log
diameters
were
obtained
from
the
True-Shape
by
using
multiple
sensors
surrounding
fallen
stem.
results
an accurate,
occlusion-free
using
multiple
sensors
surrounding
the the
fallen
stem.
ThisThis
results
in aninaccurate,
occlusion-free
and
scanning
unit
used
by cloud.
theDuring
forest
products
industry.
scans
at felled
a very
sampling
by
and
noise-free
point
During
harvest,
when
ofstems
interest
are
felled
at their
bases,
stems
noise-free
point
cloud.
harvest,
when
treesIttrees
of
interest
are
athigh-density
their
bases,
the the
stems
are
using
multiple
sensors
surrounding
the
fallen
stem.
This
results
in
an
accurate,
occlusion-free
and
are
bucked
(pruned
of
their
branches)
and
the
bark
is
removed.
Each
stem
is
then
scanned
with
the
bucked (pruned of their branches) and the bark is removed. Each stem is then scanned with the True¬© unit
noise-free
point
cloud.
harvest,
whenof
trees
of
felledinat5 their
thefrom
stemswhere
are
True-Shape
to obtain
a dense
representation
of interest
thecross-sections
stemare
cross-sections
5bases,
cm increments
from
Shape¬© unit
to obtain
aDuring
dense
representation
the stem
cminincrements
bucked
(pruned
of
their
branches)
and
the
bark
is
removed.
Each
stem
is
then
scanned
with
the
Truewhere
thewas
treecut
wastocut
the of
tipthe
of the
stem.
computed
best-fitcircle
circleon
onthe
the noiseless
noiseless and
the tree
theto tip
stem.
WeWe
computed
thethe
best-fit
¬© unit to obtain a dense representation of the stem cross-sections in 5 cm increments from where
Shape
occlusion-free
point clouds at each recorded height in order to obtain reference measurements of the
the
tree
was Removal
cut
to the
tip
ofbark
thebark
stem.
We
computed
noiseless
stem
profile.
of stem
incurred
an average
biasthe
of 1 best-fit
cm
respect
to the
field
measurements,
profile.
Removal
of stem
incurred
an average
biaswith
of circle
1 cm on
with
respect
to and
field
occlusion-free
point
clouds
eachanalysis.
recorded
in order to obtain reference measurements of the
which
was corrected
during
the
measurements,
which
wasatcorrected
duringheight
the analysis.
stem profile.
Removal
bark incurred
an average
bias
of 1 cm with
respect
to field
The three
sites thatofarestem
presented
here provided
sufficient
high-quality
material
to validate
the
measurements,
which
was
corrected
during
the
analysis.
three algorithms on a large number of trees in simulated environments
environments and
and under
under field
field conditions.
conditions.
three sites
that
are presented
here provided
sufficient
material
to validate
the
TheThe
81
trees
included
both
and
trees,
species,
and various
81 selected
selected
trees
included
both coniferous
coniferous
and deciduous
deciduoushigh-quality
trees, multiple
multiple
species,
three
algorithms
on
a
large
number
of
trees
in
simulated
environments
and
under
field
conditions.
degrees
datasets
reflect
different
potential
forest
inventory
sitessites
and
degrees of
of noise
noiseand
andocclusion.
occlusion.Thus,
Thus,these
these
datasets
reflect
different
potential
forest
inventory
The
selected
treesused
included
both
coniferous
andreference
deciduous
trees, multiple
and
various
protocols.
We used
them,
together
with
their
measurements,
to evaluate
the potential
of the
and81protocols.
We
them,
together
with reference
their
measurements,
to species,
evaluate
the potential
degrees
of noise
and
occlusion.
these
datasets
reflect
different
potential
sites
three
in forest
While
scan setups
differed
among
sites,forest
resulting
point clouds
of thealgorithms
three
algorithms
in inventories.
forestThus,
inventories.
While
scan
setups
differed
among
sites,inventory
resulting
point
and
protocols.
We
used
them,
together
with
their
reference
measurements,
to
evaluate
the
potential
were
similar
comparison.
The angularThe
resolutions
the simulated
(Newfoundland)
clouds
wereenough
similarfor
enough
for comparison.
angularof resolutions
ofscans
the simulated
scans
of the three algorithms in forest inventories. While scan setups differed among sites, resulting point
clouds were similar enough for comparison. The angular resolutions of the simulated scans

Forests 2019, 10, 599

9 of 19

and real scans (Phalsbourg) were identical (0.036‚ó¶ ). The setup of sensor positions in multi-view
scanning were comparable for all sites.
3.2. Comparison
Let us now give an overview of the four step-procedure we used to compare the three selected
algorithms. For the first step, we parameterized the algorithms with an equal number of randomly
selected trees from each test site. For the second step, we ran the three algorithms on all the selected
trees. When necessary, we eliminated branches reconstructions during a post-processing analysis: we
manually discarded cylinders fitted on erroneous parts of the point clouds. For the third step, we
transformed the set of reference measurements and estimations into continuous diameter functions
using linear interpolation. Finally, for the fourth step, we chose an error metric to compare the results
of each algorithm against the reference values.
For the first step of our methodology, we parameterized the three algorithms to achieve accurate
results for each study site. We used an iterative trial-and-error experiment to find the optimal parameter
set for each algorithm. We summarized the most important parameters for each algorithm. The two
major parameters to be established for the STEP algorithm were the size of the growing search cone
and the value of the growth-stopping criterion. The most important parameters of the CCF chain were
those of the convolution filter, the threshold in the Euclidean clustering, and the RMSE threshold for
accepting or discarding a fitted cylinder. As for the SimpleTree approach, outlier removal and the
voxel grid filter were the main processes that needed to be parameterized: the intrinsic parameters of
the SimpleTree algorithm are automatically set.
In the second step, we applied the algorithms to all trees, using the previously selected set of
parameters. Unlike STEP, results of the CCF and SimpleTree algorithms included some estimates of
branch diameters. The CCF algorithm produced some cylinders corresponding to branches. Simpletree
reconstructed entire trees, labeling cylinders as branches or as the trunk. Yet, the labels contained some
errors. Only stem diameter estimation was required for the comparison of the algorithms. Therefore,
we removed the branches based upon visual assessment. We subsequently inspected the output of the
algorithms and manually filtered erroneous cylinders.
As the third step of our methodology, we transformed the discrete diameter measurements into
continuous stem profile functions to compare the results. Allometric relationships are a valid option,
which was not explored in this study. There are many taper models from which to choose. In our
study, too few individuals were available to accurately parameterize these models. We preferred
using linear interpolations instead of allometric models. This choice was based upon simplicity and
avoided complex issues that are related to allometric modelling. The distance between each reference
measurement along the stems is small compared to tree heights (10 cm height increment for the
simulated forest plots, 2 m for the Phalsbourg dataset, and 5 cm for the Bas Saint-Laurent trees, see
Figure 5). Therefore, linear interpolation is a pertinent approach, given that it can be viewed as a
first-order limited development of the usually low curvature of taper models. For each tree, continuous
reference diameter measurements were obtained with piecewise linear interpolation of the reference
diameters (edges between black dots in Figure 5). We applied the same linear interpolation to the
output of the three algorithms.
As the final step of our methodology, we selected metrics to assess stem diameter estimation error.
To do so, both reference and estimated continuous diameter functions were regularly resampled in
2 cm increments. For each sampled height hi , the absolute error Eabs (hi ) was defined as the difference
between the absolute values of the reference diameter measurement dr (hi ) and the estimated diameter
de (hi ):
Eabs (hi ) = dr (hi ) ‚àí de (hi )
(3)

Forests 2019, 10, 599

10 of 19

We also considered the relative error Erel (hi ) which was defined as a ratio of the reference
measurements:
dr (hi ) ‚àí de (hi )
Erel (hi ) =
(4)
dr (hi )
Forests 2019, 10, 599

(a)

10 of 19

(b)

(c)

Figure
Figure 5.
5. Example
Example of
of the
the piecewise
piecewise linear
linear interpolation
interpolation of
of reference
reference measurements
measurements on
on three
three example
example
trees
from:
(a)
Newfoundland,
(b)
Phalsbourg,
and
(c)
Bas
Saint-Laurent
test
sites.
trees from: (a) Newfoundland, (b) Phalsbourg, and (c) Bas Saint-Laurent test sites.

4. Results
As the final step of our methodology, we selected metrics to assess stem diameter estimation
error.We
Tocomputed
do so, both
reference
estimated
diameter
functions
were
regularly
the error
on DBHand
and stem
profilecontinuous
for each dataset
and each
algorithm.
We computed
resampled
in
2
cm
increments.
For
each
sampled
height
‚Ñé
,
the
absolute
error
ùê∏
(‚Ñé
)
was
defined
abs
the stem profile error function globally and at tree-level, together with its minimum, maximum,
mean,
as
the
difference
between
the
absolute
values
of
the
reference
diameter
measurement
ùëë
(‚Ñé
)
and the
standard deviation and RMSE. In addition to these general statistics, we considered the distribution
of
estimated
diameter
ùëë
(‚Ñé
):
the diameter error (1) per tree and (2) per 20 cm height interval. Further, we recorded the maximum
reconstruction height for each algorithm.
(3) of
ùê∏abs (‚ÑéThis
) =height
|ùëë (‚Ñé )is‚àícomputed
ùëë (‚Ñé )| as the height above the ground
the highest diameter that was estimated by each algorithm. The point clouds did not cover the entire
We also considered the relative error ùê∏ (‚Ñé ) which was defined as a ratio of the reference
upper part of the trees because of foliage occlusion. It was difficult even for operators to provide an
measurements:
objective height at which stems were sufficiently visible to be reconstructed. Therefore, we only provide
(‚Ñé ) ‚àí ùëë the
(‚Ñé )|
maximum reconstruction heights as information|ùëëregarding
ability of algorithms to reconstruct the
ùê∏ (‚Ñé ) =
(4)
ùëë (‚Ñé )
upper parts of stems.
Details regarding the maximum height that could be measured for each tree with each method
areResults
provided in Table 2. The SimpleTree algorithm reconstructed the tree stems of the Newfoundland
4.
site up to the visible treetops, but the reconstructed stems that were obtained with the two other
We computed
the
error on portions
DBH and
stem
profile
for Phalsbourg
each dataset
and each
algorithm.
We
methods
excluded the
uppermost
of the
trees.
For the
dataset,
the three
algorithms
computed
the the
stem
profile
error
function
globally
and at tree-level,
its for
minimum,
reconstructed
stems
up to
similar
heights
with differences
of 0.5 mtogether
at most. with
Finally,
the Bas
maximum,
mean,
standard
deviation
and
RMSE.
In
addition
to
these
general
statistics,
we
considered
Saint-Laurent site, the STEP algorithm reconstructed the stems to a lower height when compared with
the
of the diameter error (1) per tree and (2) per 20 cm height interval. Further, we
CCFdistribution
and SimpleTree.
recorded the maximum reconstruction height for each algorithm. This height is computed as the
height above the groundTable
of the
highest diameter
that
was
by each algorithm. The point
2. Reconstruction
height
with
theestimated
three algorithms.
clouds did not cover the entire upper part of the trees because of foliage occlusion. It was difficult
evenReconstruction
for operators to provide
an objective
height atSite
whichPhalsbourg
stems were
visibleSite
to be
Algorithm
Newfoundland
Site sufficiently
Bas Saint-Laurent
Height [m]
reconstructed. Therefore, we only provide maximum reconstruction heights as information
11.02
5.95
CCF
9.35
regardingMean
the ability of algorithms
the upper parts of
stems.
SimpleTree to reconstruct
10.22
11.21
6.37
Details regarding the maximum
height that
could be measured
each method
STEP
8.80
10.66for each tree with4.88
3.29reconstructed the
4.17
0.92
are provided in Table 2. The CCF
SimpleTree algorithm
tree stems of the Newfoundland
Std deviation
SimpleTree
3.22
3.61
1.09
site up to the visible treetops, but the reconstructed stems that were obtained with the two other
STEP
2.09
3.58
1.42
methods excluded the uppermost portions of the trees. For the Phalsbourg dataset, the three
algorithms reconstructed the stems up to similar heights with differences of 0.5 m at most. Finally,
The
accuracy
of DBHsite,
estimation
foralgorithm
each algorithm
is illustrated
in Figure
The three
selected
for the
Bas
Saint-Laurent
the STEP
reconstructed
the stems
to a6.lower
height
when
algorithms
achieved
0.25
cm
to
3
cm
accuracy
regarding
tree
DBH
estimation.
With
fewer
outliers,
compared with CCF and SimpleTree.
higher R2 , and lower RSME, the STEP algorithm tended to produce better results than the CCF and
SimpleTree algorithms for the Phalsbourg and Bas Saint-Laurent datasets.

STEP

2.09

3.58

1.42

The accuracy of DBH estimation for each algorithm is illustrated in Figure 6. The three selected
algorithms achieved 0.25 cm to 3 cm accuracy regarding tree DBH estimation. With fewer outliers,
2, and lower RSME, the STEP algorithm tended to produce better results than the CCF and
higher
ForestsR2019,
10, 599
11 of 19
SimpleTree algorithms for the Phalsbourg and Bas Saint-Laurent datasets.

Figure
6. Diameter
at breast
height
(DBH)
estimation
error
using
three
selected
algorithms
Figure
6. Diameter
at breast
height
(DBH)
estimation
error
using
thethe
three
selected
algorithms
forfor each
site.
The
grey
each
site.
The
greydotted
dottedline
lineisisthe
the1:1
1:1line.
line.

Stem diameter errors (averaged per tree and by height) between the reference and estimated
values are shown for each study site in Figure 7 and Table 3. They show that the STEP method produces
lower mean errors for the Phalsboug and Bas Saint-Laurent sites than with the other two algorithms.
With average respective errors per tree of 2.28 cm and 1.5 cm for the Phalsbourg and Bas Saint-Laurent
sites, the STEP algorithm provides better results than the CCF algorithm and the SimpleTree algorithm.
Yet, the SimpleTree and STEP algorithms achieved similar errors on the Newfoundland dataset (1.03 cm
for SimpleTree; 1.11 cm for STEP), which were lower than what the CCF algorithm provided. On the
Phalsbourg and Bas Saint-Laurent sites, the STEP algorithm also performed better than the CCF and
SimpleTree algorithms in the lower portions of the trees. Results also show that the error recorded for
the three algorithms tended to increase with measurement height when applied to real datasets.

SimpleTree algorithm. Yet, the SimpleTree and STEP algorithms achieved similar errors on the
Newfoundland dataset (1.03 cm for SimpleTree; 1.11 cm for STEP), which were lower than what the
CCF algorithm provided. On the Phalsbourg and Bas Saint-Laurent sites, the STEP algorithm also
performed better than the CCF and SimpleTree algorithms in the lower portions of the trees. Results
also show that the error recorded for the three algorithms tended to increase with measurement
Forests 2019, 10, 599
12 of 19
height when applied to real datasets.
Mean error per height bin

(a)

(b)

(c)

(d)

(e)

(f)

Bas Saint-Laurent

Phalsbourg

Newfoundland

Mean error per tree

Figure 7. Stem profile estimation error for each site and each algorithm. The left figures (a, c, and e)
show the mean profile error for each individual tree (labelled by tree ID) and each algorithm (red, green
and blue). The right figures (b, d, and f) show the mean profile error per 20 cm bin for each site and
each algorithm.

Forests 2019, 10, 599

13 of 19

Table 3. Results of the stem diameter estimation with the three selected algorithms.
Diameter Error
per Tree [cm]

Minimum

Global average
Global
Std deviation
Global RMSE
Average error at
tree-level
Std deviation
at tree-level
Average RMSE at
tree-level
Maximum

Algorithm
CCF
SimpleTree
STEP
CCF
SimpleTree
STEP
CCF
SimpleTree
STEP
CCF
SimpleTree
STEP
CCF
SimpleTree
STEP
CCF
SimpleTree
STEP
CCF
SimpleTree
STEP
CCF
SimpleTree
STEP

Newfoundland Site
(24 Selected Trees)

Phalsbourg Site
(40 Selected Trees)

Bas Saint-Laurent Site
(17 Selected Trees)

Abs [cm]

Rel [%]

Abs [cm]

Rel [%]

Abs [cm]

Rel [%]

0.69
0.24
0.37
2.61
1.10
1.13
3.94
2.51
2.61
4.72
2.74
2.84
2.62
1.03
1.11
1.44
0.85
1.01
4.38
1.86
1.79
7.39
3.81
4.88

5.82
1.61
2.00
16.01
6.75
11.31
28.03
11.26
63.68
15.78
6.55
10.40
6.97
4.11
19.18
32.05
15.12
89.21

0.96
0.95
0.93
6.25
3.41
2.34
7.47
5.32
3.09
9.74
6.32
3.87
6.1
3.34
2.28
3.96
2.88
1.25
8.09
4.73
3.13
21.65
11.87
5.93

5.98
3.82
3.11
23.61
12.54
9.34
24.27
16.59
12.88
24.71
12.72
9.76
11.44
7.10
4.11
62.30
28.97
19.15

0.83
0.77
0.47
2.60
2.64
1.52
3.44
2.74
1.83
4.31
3.80
2.38
2.64
2.67
1.5
1.35
1.72
0.87
3.85
3.29
2.03
5.37
7.35
3.57

18.92
8.13
4.69
18.52
16.94
8.95
28.12
13.95
10.57
18.92
16.85
9.31
12.31
5.01
4.82
60.81
27.27
24.25

5. Discussion
This study aimed at expanding our current capabilities to estimate stem profile. We tested the
STEP algorithm in natural forest environments and provided quantitative results on forest scenes
instead of the visual assessments in [54]. Our results illustrated how the STEP algorithm is resilient
to occlusion and noise in the point cloud. The RMSE values obtained for DBH estimation by the
three algorithms (Figure 6) were improved when compared with previous studies. In addition, of
the three algorithms, the STEP algorithm stands out with lower RMSE and higher R2 than CCF and
Simpletree: RMSE on DBH estimates ranged from 0.21 to 0.56 cm for STEP, from 0.24 to 2.94 cm for
CCF, and from 0.25 to 2.28 cm for Simpletree. In comparison, several other studies propose a range
of RMSE for DBH estimates: 0.7 to 7 cm [15], 2 to 4.2 cm [31], 0.53 to 0.73 cm [67], 2.39 cm [68], and
1.27 cm [69]. In addition to DBH estimation, algorithms were compared for their ability to estimate the
tree rate detection [24,70], or above ground biomass [56,57,71,72]. For example, Ohtmani et al. [24]
evaluated the CCF algorithm on stem detection rate and DBH, and Hackenberg et al. [40,58] evaluated
SimpleTree on DBH and aboveground biomass estimation. Evaluating the algorithms for stem profiles
is more challenging than estimating DBH or aboveground biomass, particularly for acquiring reliable
reference datasets.
Our results concur with the few studies available on the estimation of the stem profile.
STEP estimated stem profile with mean RMSE per tree ranging from 1.79 to 2.03 cm. These results
are better than those from Maas et al. [73] with an RMSE of 4.7 cm obtained on a single tree.
Henning et al. [27] obtained an average diameter error of 0.2 cm (with a standard deviation of 2.1 cm)
for their estimation of stem profiles, but it was based on tenth-percentiles of all fitted circles within
each vertical bins of 1 m. More recently, Liang et al. [46] obtained an RMSE on stem profile of 1.13 cm.
This low value can be explained by two aspects related to their experiment: the plot scanned from
7 positions (hence diminishing occlusions) and the stem profiles were filtered (through a smoothing
procedure). These studies and our work highlight the difficulty to estimate stem profiles within a
compact crown where occlusion occurs and sampling density varies greatly [15,31]. Consequently,

Forests 2019, 10, 599

14 of 19

stem profile estimation error increases with height in the crown (Figure 7). In order to overcome
constraints due to signal occlusion, several studies tested their algorithms in relatively favorable
conditions. They selected leafless or isolated trees, or either scanned each target tree from 3 to 4 scan
positions [8,40,56,57,71] and up to 7 or 8 scan positions [46,59]. In contrast, our evaluation is based on
81 trees from point clouds collected using a practical protocol adapted for natural forest stand involving
4 to 5 scans per plot [23]. Such configuration generates point clouds with a higher signal occlusion and
variable sampling density compared with experiments tailored for individual tree involving multiple
scans per tree. Many methods try to overcome noise and occlusion by applying filters before the
geometrical reconstruction of stems [59,67,71]. The main goal of such filters is to remove noise from
the data. Some methods also filter the estimated stem profile with smoothing or using allometry to
correct unrealistic results [46,58]. Similarly, our tests with the CCF algorithm and SimpleTree required
manual processing: cylinders generated had to be manually processed to keep only those visually
associated with the tree stem. The fully automated STEP algorithm instead used unfiltered input
data and unaltered results. This configuration was adopted to test STEP ability to deal with signal
occlusion and variable sampling. Overall, the results obtained from STEP are generally equivalent or
better than those obtained from the CCF algorithm and SimpleTree (Figure 7 and Table 3). This is a
strong argument to believe that the complexity of the STEP algorithm, in particular the adoption of the
computationally intensive 4D Hough transform, is an effective solution for forest inventories.
We faced several limitations during this study. The foremost limitation is the availability of
reference datasets with reliable in situ measurements of the diameter along the entire stem. Adopting a
virtual scene has the advantage of testing methods against an absolute reference [40,56,74,75]. However,
simulated point clouds do not reach the complexity of in situ scans of forest stands. Noise in the point
cloud and complete architecture of natural stands are important factors affecting the accuracy of the
estimates. Hence a comprehensive evaluation therefore requires non-simulated datasets. While DBH
can be easily measured in situ, stem diameter with height is rarely measured manually. That is why
most existing studies focused on DBH estimation instead of stem profile. We circumvented this
limitation by using two references datasets using the TruShape scanner (Bas St-Laurent site) and in
situ diameter measurement after felling the trees (Phalsbourg site). As a second limitation, there is a
wide array of processing and parameterization options. For instance, manual cylinder adjustment was
applied to the CCF algorithm and SimpleTree but not on the STEP algorithm. These different options
make algorithms comparison difficult. Regardless, the estimated stem profile from the three methods
were very close to what was measured in situ. Considering that stem profile is not easily measured in
situ, the TLS-driven algorithms are an important step towards improving forest inventories. A third
limitation was the ability of the algorithms to deal with signal occlusion, variable sampling and noise
within the point cloud. This limitation has been raised as one of the major constraints for algorithm
development [15,31]. Considering that STEP automatically processed unfiltered datasets, it stands out
favorably in our analysis with lower RMSE, when compared with the CCF algorithm and SingleTree,
for its ability to deal with this limitation.
From our tests and results, we suggest three ways to improve the current stem profile estimation
methods. First, procedures can be found in the literature to ease point cloud processing such as point
filtering [76], normal vector assessment [62,76,77], or wood-foliage separation to name a few [78,79].
They can reduce noise or the number of irrelevant objects (e.g., foliage) present in point clouds.
They can also reduce point density to improve computing time. These procedures could be tested to
identify those relevant and suggest a unified framework prior to applying profile estimation algorithms.
Such framework would facilitate algorithms comparison on a common base and ease algorithm
development. In addition, proposing sensitivity analyses can guide users on how to parameterize
the algorithms, and guide the developers towards auto-parametrizing algorithms, which is a current
limitation. For example, SimpleTree and Kunz et al. [71] integrated what they called, ‚Äúbrute-force
auto-parameterization‚Äù, which is not the case for the CCF, STEP and most algorithms. A second
potential improvement is to enhance the stem profile estimation in the upper part of the tree crown.

Forests 2019, 10, 599

15 of 19

Table 2 identified how STEP can reconstruct stem profiles up to a height 0.5 m to 1.1 m, and 1.5 m
lower than what was available from the CCF algorithm and SimpleTree respectively. This current
limitation of the STEP algorithm is associated with its growth stopping criterion, which needs to
be made adaptive according to position in the crown and point cloud conditions. A third potential
improvement relates to the TLS acquisition procedures. Considering that occlusions and sampling
density affect the algorithms, TLS acquisition protocols can be set up to reduce occlusions. This implies
more scans at different positions and results in larger point clouds. Yet, managing huge point clouds is
also a serious problem, therefore, a compromise needs to be found. Stem reconstruction from point
clouds does not need to be restricted to TLS datasets. Mobile sensors are becoming available and
affordable. Similarly, LiDARs mounted on Unmanned Airborne Vehicles (UAVs) acquire coarser point
clouds than TLS but they provide an improved visibility of the upper part of the trees. Therefore, UAV
LiDAR data may prove to be appropriate for upper stem diameter estimations. However, testing the
available algorithms on such data remains to be explored.
6. Conclusions
We validated the STEP algorithm with a large set of trees that were extracted from TLS acquisitions
in forest environments under various conditions. Overall, the results show that accuracy of the STEP
method is comparable to that of manual measurements with conventional instruments, with mean
errors ranging from 1 cm to 2 cm. We also compared the STEP algorithm to two other approaches
that are dedicated to stem diameter estimation. The STEP algorithm was more effective when
dealing with occluded and noisy point clouds than were the other two methods. We highlighted
differences in the processing chains of each algorithm; we believe that adoption of common pre- and
post-processing protocols could further improve the current results. The increasing robustness of
automatic measurement algorithms pushes the limits of LiDAR-aided forest inventories. Yet, new
instruments and technologies (e.g., drone LiDAR and drone photogrammetry) widen the possible
application of our present solutions to other operational contexts.
Author Contributions: Conceptualization, J.R., R.A.F. and A.B.; Data Curation, U.R., J.F.C. and A.P.; Formal
Analysis, J.R.; Funding Acquisition, R.A.F.; Investigation, J.R.; Methodology, J.R., R.A.F. and A.B.; Project
Administration, R.A.F., J.F.C.; Software, J.R.; Supervision, R.A.F. and J.R.; Validation, J.R., J.F.C., R.A.F. and A.B.;
Visualization, J.R. and R.A.F.; Writing‚ÄîOriginal Draft, J.R., R.A.F. and A.B.; Writing‚ÄîReview & Editing, J.R.,
R.A.F., C.V., J.F.C., A.B. and A.P.
Funding: This research was supported by research grants from FRQNT (Fonds de recherche du Qu√©bec‚ÄîNature
et technologies) and NSERC (Natural Sciences and Engineering Research Council of Canada). The FRQNT project
was entitled ‚ÄúAm√©lioration de l‚Äôexactitude et du contenu en information structurale de l‚Äôinventaire forestier‚Äù
(FRQNT file: FT104357, Grantee: J. B√©gin, SFB, Ulaval). NSERC funding was linked with the AWARE project
(NSERC File: CRDPJ 462973-14, Grantee: N.C. Coops, FRM, UBC), in collaboration with the Canadian Wood
Fiber Centre (CWFC), FP-Innovations, and the forest products company Corner Brook Pulp and Paper Ltd.
(Corner Brook, NL, Canada) forest company. C√©dric Vega is supported by a public grant overseen by the French
National Research Agency (ANR) as part of the ‚ÄúInvestissements d‚ÄôAvenir‚Äù program (ANR-11-LABX-0002-01, Lab
of Excellence ARBRE).
Acknowledgments: We thank Jan Hackenberg of the DIABOLO (Distributed, Integrated and Harmonised Forest
Information for Bioeconomy Outlooks) project for his support with the Computree version of SimpleTree.
Conflicts of Interest: The authors declare no conflict of interest. The funders had no role in the design of the
study; in the collection, analyses, or interpretation of data; in the writing of the manuscript, or in the decision to
publish the results.

References
1.

2.

Feldpausch, T.R.; Banin, L.; Phillips, O.; Baker, T.R.; Lewis, S.L.; Quesada, C.A.; Affum-Baffoe, K.;
Arets, E.J.M.M.; Berry, N.J.; Bird, M.; et al. Height-diameter allometry of tropical forest trees. Biogeosciences
2011, 8, 1081‚Äì1106. [CrossRef]
Fortin, M.; Schneider, R.; Saucier, J.-P. Volume and Error Variance Estimation Using Integrated Stem Taper
Models. For. Sci. 2012, 59, 345‚Äì358. [CrossRef]

Forests 2019, 10, 599

3.

4.

5.
6.
7.
8.

9.
10.
11.

12.

13.
14.
15.

16.

17.
18.

19.
20.

21.
22.
23.

24.

16 of 19

Wulder, M.A.; White, J.C.; Fournier, R.A.; Luther, J.E.; Magnussen, S. Spatially Explicit Large Area Biomass
Estimation: Three Approaches Using Forest Inventory and Remotely Sensed Imagery in a GIS. Sensors 2008,
8, 529‚Äì560. [CrossRef] [PubMed]
Black, K.; Reidy, B.; Bolger, T.; Tobin, B.; Osborne, B.; Nieuwenhuis, M. Assessment of allometric algorithms
for estimating leaf biomass, leaf area index and litter fall in different-aged Sitka spruce forests. Forestry 2006,
79, 453‚Äì465.
K√∂hl, M.; Magnussen, S.; Marchetti, M. Sampling Methods, Remote Sensing and GIS Multiresource Forest
Inventory; Springer Science & Business Media: Berlin, Germany, 2006.
van Laar, A.; Akca, A. Forest Mensuration; Springer Science & Business Media: Berlin, Germany, 2007.
Avery, T.E.; Burkhart, H.E. Forest Measurements; McGraw-Hill: New York, NY, USA, 2001.
Dassot, M.; Colin, A.; Santenoise, P.; Fournier, M.; Constant, T. Terrestrial laser scanning for measuring the solid
wood volume, including branches, of adult standing trees in the forest environment. Comput. Electron. Agric.
2012, 89, 86‚Äì93. [CrossRef]
Dassot, M.; Constant, T.; Fournier, M. The use of terrestrial LiDAR technology in forest science: Application
fields, benefits and challenges. Ann. For. Sci. 2011, 68, 959‚Äì974. [CrossRef]
Vosselman, G.; Maas, H.-G. Airborne and Terrestrial Laser Scanning; CRC Press: Boca Raton, FL, USA, 2010;
p. 318.
Bouvier, M.; Durrieu, S.; Fournier, R.; Saint-Geours, N.; Vincent, G.; Guyon, D.; Grau, E.; H√©rault, B. Influence
of sampling design parameters on biomass predictions derived from airborne lidar data. In Proceedings of
the SilviLaser 2015, La Grande Motte, France, 28‚Äì30 September 2015; pp. 137‚Äì139.
Falkowski, M.J.; Smith, A.M.; Hudak, A.T.; E Gessler, P.; A Vierling, L.; Crookston, N.L. Automated estimation
of individual conifer tree height and crown diameter via two-dimensional spatial wavelet analysis of lidar
data. Can. J. Remote Sens. 2006, 32, 153‚Äì161. [CrossRef]
N√¶sset, E. Predicting forest stand characteristics with airborne scanning laser using a practical two-stage
procedure and field data. Remote Sens. Environ. 2002, 80, 88‚Äì99. [CrossRef]
Vepakomma, U.; St-Onge, B.; Kneeshaw, D. Spatially explicit characterization of boreal forest gap dynamics
using multi-temporal lidar data. Remote Sens. Environ. 2008, 112, 2326‚Äì2340. [CrossRef]
Liang, X.; Kankare, V.; Hyypp√§, J.; Wang, Y.; Kukko, A.; Haggr√©n, H.; Yu, X.; Kaartinen, H.; Jaakkola, A.;
Guan, F.; et al. Terrestrial laser scanning in forest inventories. ISPRS J. Photogramm. Remote Sens. 2016, 115,
63‚Äì77. [CrossRef]
Metz, J.; Seidel, D.; Schall, P.; Scheffer, D.; Schulze, E.-D.; Ammer, C. Crown modeling by terrestrial laser
scanning as an approach to assess the effect of aboveground intra-and interspecific competition on tree
growth. For. Ecol. Manag. 2013, 310, 275‚Äì288. [CrossRef]
Olivier, M.-D.; Robert, S.; Fournier, R.A. Response of sugar maple (Acer saccharum, Marsh.) tree crown
structure to competition in pure versus mixed stands. For. Ecol. Manag. 2016, 374, 20‚Äì32. [CrossRef]
Durrieu, S.; Allouis, T.; Fournier, R.; V√©ga, C.; Albrech, L. Spatial quantification of vegetation density from
terrestrial laser scanner data for characterization of 3D forest structure at plot level. In Proceedings of the
SilviLaser 2008, Edinburgh, UK, 17‚Äì19 September 2008; pp. 325‚Äì334.
B√©land, M.; Widlowski, J.-L.; Fournier, R.A.; C√¥t√©, J.-F.; Verstraete, M.M. Estimating leaf area distribution in
savanna trees from terrestrial LiDAR measurements. Agric. For. Meteorol. 2011, 151, 1252‚Äì1266. [CrossRef]
Hosoi, F.; Nakai, Y.; Omasa, K. Voxel tree modeling for estimating leaf area density and woody material
volume using 3-D LIDAR data. ISPRS Ann. Photogramm. Remote Sens. Spat. Inf. Sci. 2013, 5, 115‚Äì120.
[CrossRef]
C√¥t√©, J.-F.; Fournier, R.A.; Egli, R. An architectural model of trees to estimate forest structural attributes using
terrestrial LiDAR. Environ. Model. Softw. 2011, 26, 761‚Äì777. [CrossRef]
C√¥t√©, J.-F.; Fournier, R.A.; Frazer, G.W.; Niemann, K.O. A fine-scale architectural model of trees to enhance
LiDAR-derived measurements of forest canopy structure. Agric. For. Meteorol. 2012, 166, 72‚Äì85. [CrossRef]
Blanchette, D.; Fournier, R.A.; Luther, J.E.; C√¥t√©, J.-F. Predicting wood fiber attributes using local-scale metrics
from terrestrial LiDAR data: A case study of Newfoundland conifer species. For. Ecol. Manag. 2015, 347,
116‚Äì129. [CrossRef]
Othmani, A.; Piboule, A.; Krebs, M.; Stolz, C. Towards automated and operational forest inventories with
T-Lidar. In Proceedings of the SilviLaser 2011, Hobart, Australia, 16‚Äì20 October 2011; pp. 1‚Äì9.

Forests 2019, 10, 599

25.
26.
27.
28.
29.

30.
31.
32.
33.
34.
35.

36.
37.
38.

39.
40.
41.

42.

43.
44.
45.
46.
47.

17 of 19

Kuusk, A.; Lang, M.; M√§rdla, S.; Pisek, J. Tree stems from terrestrial laser scanner measurements. For. Stud.
2015, 63, 44‚Äì55. [CrossRef]
Brunner, A.; Gizachew, B. Rapid detection of stand density, tree positions, and tree diameter with a 2D
terrestrial laser scanner. Eur. J. For. Res. 2014, 133, 819‚Äì831. [CrossRef]
Henning, J.G.; Radtke, P.J. Detailed stem measurements of standing trees from ground-based scanning lidar.
For. Sci. 2006, 52, 67‚Äì80.
Bienert, A.; Scheller, S.; Keane, E.; Mullooly, G.; Mohan, F. Application of Terrestrial Laser Scanners For The
Determination Of Forest Inventory Parameters. Int. Arch. Photogramm. Remote Sens. Spat. Inf. Sci. 2006, 36, 5.
Schilling, A.; Schmidt, A.; Maas, H.-G. Automatic Tree Detection and Diameter Estimation in Terrestrial
Laser Scanner Point Clouds. In Proceedings of the 16th Computer Vision Winter Workshop, Mitterberg,
Austria, 2‚Äì4 February 2011; pp. 75‚Äì83.
Lindberg, E.; Holmgren, J.; Olofsson, K.; Olsson, H. Estimation of stem attributes using a combination of
terrestrial and airborne laser scanning. Eur. J. For. Res. 2012, 131, 1917‚Äì1931. [CrossRef]
Olofsson, K.; Holmgren, J.; Olsson, H. Tree Stem and Height Measurements using Terrestrial Laser Scanning
and the RANSAC Algorithm. Remote Sens. 2014, 6, 4323‚Äì4344. [CrossRef]
Kir√°ly, G.; Brolly, G. Modelling single trees from terrestrial laser scanning data in a forest reserve. Photogramm.
J. Finl. 2008, 21, 37‚Äì50.
Aschoff, T.; Spiecker, H. Algorithms for the automatic detection of trees in laser scanner data. Int. Arch.
Photogramm. Remote Sens. Spat. Inf. Sci. 2004, 36, W2.
P√°l, I. Measurements of Forest Inventory Parameters on Terrestrial Laser Scanning Data Using Digital
Geometry and Topology. Int. Arch. Photogramm. Remote Sens. Spat. Inf. Sci. 2008, 37, 373‚Äì380.
Belton, D.; Moncrieff, S.; Chapman, J. Processing tree point clouds using Gaussian Mixture Models.
In Proceedings of the ISPRS annals of the photogrammetry, remote sensing and spatial information sciences,
Antalya, Turkey, 1‚Äì13 November 2013.
Aiteanu, F.; Klein, R. Hybrid tree reconstruction from inhomogeneous point clouds. Vis. Comput. 2014, 30,
763‚Äì771. [CrossRef]
√Ökerblom, M.; Raumonen, P.; Kaasalainen, M.; Casella, E.; Baghdadi, N.; Thenkabail, P.S. Analysis of
Geometric Primitives in Quantitative Structure Models of Tree Stems. Remote Sens. 2015, 7, 4581‚Äì4603.
Simonse, M.; Aschoff, T.; Spiecker, H.; Thies, M. Automatic determination of forest inventory parameters
using terrestrial laser scanning. In Proceedings of the ScandLaser Scientific Workshop on Airborne Laser
Scanning of Forests, Ume√•, Sweden, 3‚Äì4 September 2003; Volume 2003, pp. 252‚Äì258.
Pfeifer, N.; Winterhalder, D.; Gorte, B.G.H. Three-dimensional reconstruction of stems for assessment of
taper, sweep and lean based on laser scanning of standing trees. Scand. J. For. Res. 2004, 19, 571‚Äì581.
Hackenberg, J.; Morhart, C.; Sheppard, J.; Spiecker, H.; Disney, M. Highly Accurate Tree Models Derived
from Terrestrial Laser Scan Data: A Method Description. Forests 2014, 5, 1069‚Äì1105. [CrossRef]
Wezyk, P.; Kozio≈Ç, K.; Glista, M.; Pierzchalski, M. Terrestrial laser scanning versus traditional forest inventory
first results from the polish forests. In Proceedings of the ISPRS Workshop on Laser Scanning 2007 and
SilviLaser 2007, Espoo, Finland, 12‚Äì14 September 2007; Volume 36, pp. 424‚Äì429.
Yan, D.; Wintz, J.; Mourrain, B.; Wang, W.; Bourdon, F.; Godin, C. Efficient and robust tree model reconstruction
from laser scanned data points. In Proceedings of the 11th IEEE International conference on Computer-Aided
Design and Computer Graphics 2009, Huangshan, China, 19‚Äì21 August 2009; pp. 572‚Äì576.
Moskal, L.M.; Zheng, G. Retrieving forest inventory variables with terrestrial laser scanning (TLS) in urban
heterogeneous forest. Remote Sens. 2012, 4, 1‚Äì20. [CrossRef]
Pfeifer, N.; Winterhalder, D. Modelling of tree cross sections from terrestrial laser scanning data with free-form
curves. Int. Arch. Photogramm. Remote Sens. Spat. Inf. Sci. 2004, 36, W2.
Liang, X.; Litkey, P.; Hyyppa, J.; Kaartinen, H.; Vastaranta, M.; Holopainen, M. Automatic Stem Mapping
Using Single-Scan Terrestrial Laser Scanning. IEEE Trans. Geosci. Remote Sens. 2012, 50, 661‚Äì670. [CrossRef]
Kankare, V.; Liang, X.; Yu, X.; Hyyppa, J.; Holopainen, M. Automated Stem Curve Measurement Using
Terrestrial Laser Scanning. IEEE Trans. Geosci. Remote Sens. 2014, 52, 1739‚Äì1748.
Kelbe, D.; Romanczyk, P.; Van Aardt, J.; Cawse-Nicholson, K. Reconstruction of 3D tree stem models from
low-cost terrestrial laser scanner data. In Laser Radar Technology and Applications XVIII; International Society
for Optics and Photonics: Bellingham, WA, USA, 2013; Volume 8731, p. 873106.

Forests 2019, 10, 599

48.
49.

50.
51.
52.

53.
54.
55.
56.

57.
58.
59.
60.
61.
62.

63.
64.
65.
66.
67.
68.

69.
70.

18 of 19

McDaniel, M.W.; Nishihata, T.; Brooks, C.A.; Salesses, P.; Iagnemma, K. Terrain classification and identification
of tree stems using ground-based LiDAR. J. Field Robot. 2012, 29, 891‚Äì910. [CrossRef]
Kelbe, D.; Romanczyk, P. Automatic extraction of tree stem models from single terrestrial lidar scans in
structurally heterogeneous forest environments. In Proceedings of the 12th International Conference on
LiDAR Applications for Assessing Forest Ecosystems 2012, Vancouver, BC, Canada, 16‚Äì19 September 2012;
pp. 1‚Äì8.
Hildebrandt, R.; Iost, A. From points to numbers: A database-driven approach to convert terrestrial LiDAR
point clouds to tree volumes. Eur. J. For. Res. 2012, 131, 1857‚Äì1867. [CrossRef]
Aschoff, T.; Thies, M.; Spiecker, H. Describing forest stands using terrestrial laser-scanning. Int. Arch.
Photogramm. Remote Sens. Spat. Inf. Sci. 2004, 35, 237‚Äì241.
Huang, H.; Li, Z.; Gong, P.; Cheng, X.; Clinton, N.; Cao, C.; Ni, W.; Wang, L. Automated Methods for
Measuring DBH and Tree Heights with a Commercial Scanning Lidar. Photogramm. Eng. Remote Sens. 2011,
77, 219‚Äì227. [CrossRef]
Xi, Z.; Hopkinson, C.; Chasmer, L. Automating Plot-Level Stem Analysis from Terrestrial Laser Scanning.
Forests 2016, 7, 252. [CrossRef]
Ravaglia, J.; Bac, A.; Fournier, R.A. Extraction of tubular shapes from dense point clouds and application to
tree reconstruction from laser scanned data. Comput. Graph. 2017, 66, 23‚Äì33. [CrossRef]
C√¥t√©, J.-F.; Fournier, R.A.; Luther, J.E. Validation of L-Architect model for balsam fir and black spruce trees
with structural measurements. Can. J. Remote Sens. 2013, 39, S41‚ÄìS59. [CrossRef]
Raumonen, P.; Kaasalainen, M.; Akerblom, M.; Kaasalainen, S.; Kaartinen, H.; Vastaranta, M.; Holopainen, M.;
Disney, M.; Lewis, P. Fast Automatic Precision Tree Models from Terrestrial Laser Scanner Data. Remote Sens.
2013, 5, 491‚Äì520. [CrossRef]
Raumonen, P.; Casella, E.; Calders, K.; Murphy, S.; √Ökerbloma, M.; Kaasalainen, M. Massive-Scale Tree
Modelling from TLS Data. ISPRS Ann. Photogramm. Remote Sens. Spat. Inf. Sci. 2015, II-3/W4, 189‚Äì196. [CrossRef]
Hackenberg, J.; Wassenberg, M.; Spiecker, H.; Sun, D. Non Destructive Method for Biomass Prediction
Combining TLS Derived Tree Volume and Wood Density. Forests 2015, 6, 1274‚Äì1300. [CrossRef]
Hackenberg, J.; Spiecker, H.; Calders, K.; Disney, M.; Raumonen, P. SimpleTree‚ÄîAn Efficient Open Source
Tool to Build Tree Models from TLS Clouds. Forests 2015, 6, 4245‚Äì4294. [CrossRef]
Amanatides, J.; Woo, A. A Fast Voxel Traversal Algorithm for Ray Tracing; Eurographics: Montreal, QC, Canada,
1987; Volume 87, pp. 3‚Äì10.
Kass, M.; Witkin, A.; Terzopoulos, D. Snakes: Active contour models. Int. J. Comput. Vis. 1988, 1, 321‚Äì331.
[CrossRef]
Ravaglia, J.; Bac, A.; Fournier, R.A. Anisotropic Octrees: A Tool for Fast Normals Estimation on
Unorganized Point Clouds. In Proceedings of the Winter School of Computer Graphics (WSCG) 2017, Plzen,
Czech Republic, 29 May‚Äì2 June 2017.
Pfeifer, N.; Gorte, B.; Winterhalder, D. Automatic Reconstruction of Single Trees From Terrestrial Laser
Scanner Data. In Proceedings of the 20th ISPRS Congress, Istanbul, Turkey, 12‚Äì23 July 2004; pp. 114‚Äì119.
P√¥le Recherche D√©veloppement Innovation, Office National des For√™ts. Computree Official Website. 2019.
Available online: http://computree.onf.fr/?lang=en (accessed on 5 August 2017).
Pharr, M.; Jakob, W.; Humphreys, G. Physically Based Rendering: From Theory to Implementation; Morgan
Kaufmann: Burlington, MA, USA, 2016.
Saucier, J.-P.; Grondin, P.; Robitaille, A.; Bergeron, J.-F. Zone de V√©g√©tation des Domaines Bioclimatiques du
Qu√©bec; Minist√®re des Ressources Naturelles, Direction des Inventaires Forestiers: Quebec, QC, Canada, 2001.
Pitk√§nen, T.P.; Raumonen, P.; Kangas, A. Measuring stem diameters with TLS in boreal forests by
complementary fitting procedure. ISPRS J. Photogramm. Remote Sens. 2019, 147, 294‚Äì306. [CrossRef]
Calders, K.; Newnham, G.; Burt, A.; Murphy, S.; Raumonen, P.; Herold, M.; Culvenor, D.; Avitabile, V.;
Disney, M.; Armston, J.; et al. Nondestructive estimates of above-ground biomass using terrestrial laser
scanning. Methods Ecol. Evol. 2015, 6, 198‚Äì208. [CrossRef]
Wang, P.; Li, R.; Bu, G.; Zhao, R. Automated low-cost terrestrial laser scanner for measuring diameters at
breast height and heights of plantation trees. PLoS ONE 2019, 14, e0209888. [CrossRef]
Zhang, W.; Wan, P.; Wang, T.; Cai, S.; Chen, Y.; Jin, X.; Yan, G. A Novel Approach for the Detection of Standing
Tree Stems from Plot-Level Terrestrial Laser Scanning Data. Remote Sens. 2019, 11, 211. [CrossRef]

Forests 2019, 10, 599

71.

72.

73.
74.
75.

76.
77.
78.

79.

19 of 19

Kunz, M.; Hess, C.; Raumonen, P.; Bienert, A.; Hackenberg, J.; Maas, H.-G.; H√§rdtle, W.; Fichtner, A.;
Oheimb, G. Comparison of wood volume estimates of young trees from terrestrial laser scan data. iForest
Biogeosci. For. 2017, 10, 451‚Äì458. [CrossRef]
Gonzalez de Tanago, J.; Lau, A.; Bartholomeus, H.; Herold, M.; Avitabile, V.; Raumonen, P.; Martius, C.;
Goodman, R.C.; Disney, M.; Manuri, S.; et al. Estimation of above-ground biomass of large tropical trees
with terrestrial LiDAR. Methods Ecol. Evol. 2018, 9, 223‚Äì234. [CrossRef]
Maas, H.-G.; Bienert, A.; Scheller, S.; Keane, E. Automatic forest inventory parameter determination from
terrestrial laser scanner data. Int. J. Remote Sens. 2008, 29, 1579‚Äì1593. [CrossRef]
Leblanc, S.; Fournier, R. Hemispherical photography simulations with an architectural model to assess
retrieval of leaf area index. Agric. For. Meteorol. 2014, 194, 64‚Äì76. [CrossRef]
C√¥t√©, J.-F.; Fournier, R.A.; Luther, J.E.; Van Lier, O.R. Fine-scale three-dimensional modeling of boreal forest
plots to improve forest characterization with remote sensing. Remote Sens. Environ. 2018, 219, 99‚Äì114.
[CrossRef]
Rusu, R.B.; Cousins, S. 3D is here: Point Cloud Library (PCL). In Proceedings of the IEEE International
Conference on Robotics and Automation, Shanghai, China, 9‚Äì13 May 2011.
Boulch, A.; Marlet, R. Deep Learning for Robust Normal Estimation in Unstructured Point Clouds.
Comput. Graph. Forum 2016, 35, 281‚Äì290. [CrossRef]
Brodu, N.; Lague, D. 3D terrestrial lidar data classification of complex natural scenes using a multi-scale
dimensionality criterion: Applications in geomorphology. ISPRS J. Photogramm. Remote Sens. 2012, 68,
121‚Äì134. [CrossRef]
Martin-Ducup, O.; Schneider, R.; Fournier, R.A. Analyzing the Vertical Distribution of Crown Material in
Mixed Stand Composed of Two Temperate Tree Species. Forests 2018, 9, 673. [CrossRef]
¬© 2019 by the authors. Licensee MDPI, Basel, Switzerland. This article is an open access
article distributed under the terms and conditions of the Creative Commons Attribution
(CC BY) license (http://creativecommons.org/licenses/by/4.0/).

